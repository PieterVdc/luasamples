REM Action points:
REM 1 ENEMY CREATURE SPAWN POINT
REM 2 ENEMY CREATURE SPAWN POINT
REM 3 ENEMY CREATURE SPAWN POINT
REM 4 ENEMY CREATURE SPAWN POINT
REM 5 ENEMY CREATURE SPAWN POINT
REM 6 ENEMY CREATURE SPAWN POINT
REM 7 ENEMY CREATURE SPAWN POINT
REM 8 ENEMY CREATURE SPAWN POINT
REM 9 ENEMY CREATURE SPAWN POINT
REM 10 ENEMY CREATURE SPAWN POINT
REM 11 ENEMY CREATURE SPAWN POINT
REM 12 ENEMY CREATURE SPAWN POINT
REM 13 ENEMY CREATURE SPAWN POINT
REM 14 ENEMY CREATURE SPAWN POINT 
REM 15 ENEMY CREATURE SPAWN POINT
REM 16 ENEMY CREATURE SPAWN POINT
REM 17 ENEMY CREATURE SPAWN POINT
REM 18 ENEMY CREATURE SPAWN POINT
REM 19 ENEMY CREATURE SPAWN POINT
REM 20 ENEMY CREATURE SPAWN POINT
REM 11 ENEMY CREATURE SPAWN POINT
REM 12 ENEMY CREATURE SPAWN POINT
REM 13 ENEMY CREATURE SPAWN POINT
REM 14 ENEMY CREATURE SPAWN POINT
REM 15 ENEMY CREATURE SPAWN POINT
REM 16 ENEMY CREATURE SPAWN POINT
REM 17 ENEMY CREATURE SPAWN POINT
REM 18 ENEMY CREATURE SPAWN POINT
REM 19 ENEMY CREATURE SPAWN POINT
REM 20 ENEMY CREATURE SPAWN POINT
REM 21 ENEMY CREATURE SPAWN POINT
REM 22 ENEMY CREATURE SPAWN POINT
REM 23 ENEMY CREATURE SPAWN POINT
REM 24 ENEMY CREATURE SPAWN POINT
REM 25 ENEMY CREATURE SPAWN POINT
REM 26 ENEMY CREATURE SPAWN POINT
REM 27 ENEMY CREATURE SPAWN POINT
REM 28 ENEMY CREATURE SPAWN POINT
REM 29 ENEMY CREATURE SPAWN POINT
REM 30 ENEMY CREATURE SPAWN POINT
REM 31 ENEMY CREATURE SPAWN POINT
REM 32 ENEMY CREATURE SPAWN POINT
REM 33 PLAYER CREATURE-BOX SPAWN POINT 2
REM 34 PLAYER CREATURE-BOX SPAWN POINT 3
REM 35 PLAYER CREATURE-BOX SPAWN POINT 4
REM 36 PLAYER CREATURE-BOX SPAWN POINT 5
REM 37 PLAYER CREATURE-BOX SPAWN POINT 6
REM 38 PLAYER CREATURESPAWN POINT 2
REM 39 PLAYER CREATURESPAWN POINT 3
REM 30 PLAYER CREATURESPAWN POINT 4
REM 41 PLAYER CREATURESPAWN POINT 5
REM 42 PLAYER CREATURESPAWN POINT 6
REM 43 PLAYER DISPLAY CREATURE COST 1
REM 44 PLAYER DISPLAY CREATURE COST 2
REM 45 PLAYER DISPLAY CREATURE COST 3
REM 46 PLAYER DISPLAY CREATURE COST 4
REM 47 PLAYER DISPLAY CREATURE COST 5
REM 48 PLAYER DISPLAY CREATURE COST 6
REM 49 PLAYER IMP SPAWN
REM 50 HEART DAMAGE VISUAL EFFECT
REM 51 HEART DAMAGE VISUAL EFFECT
REM 52 HEART DAMAGE VISUAL EFFECT
REM 53 HEART DAMAGE VISUAL EFFECT
REM 54 HEART DAMAGE VISUAL EFFECT
REM 55 HEART DAMAGE VISUAL EFFECT
REM 56 HEART DAMAGE VISUAL EFFECT
REM 57 HEART DAMAGE VISUAL EFFECT
REM 58 HEART DAMAGE VISUAL EFFECT
REM 59 GOLD REWARD SURVIVED
REM 60 GOLD REWARD SURVIVED
REM 61 PLAYER CREATURE-BOX SPAWN POINT 1
REM 62 PLAYER CREATURESPAWN POINT 1
REM 63 BATTLEFIELD CREATURE COUNTER
REM 64 CREATURE KILLER AT WHITE HEART
REM 65 CREATURE SELECTOR COUNTER 
REM 66 CREATURE SELECTOR COUNTER
REM 67 GOLD REWARD SURVIVED
REM 68 GOLD REWARD SURVIVED
REM 69 GOLD REWARD SURVIVED
REM 70 GOLD REWARD SURVIVED
REM 71 GOLD REWARD SURVIVED
REM 72 GOLD REWARD SURVIVED
REM 73 GOLD REWARD SURVIVED
REM 74 CHANGE OWNER RANGE
REM 75 CHANGE OWNER RANGE
REM 76 CHANGE OWNER RANGE
REM 77 CHANGE OWNER RANGE
REM 78 CHANGE OWNER RANGE
REM 79 CHANGE OWNER RANGE
REM 80 GOLD REWARD ROUND

REM Timers:
REM PLAYER0,TIMER0 COUNTDOWN
REM PLAYER0,TIMER1 REMAKE BOX FLOOR TIMER 
REM PLAYER0,TIMER2 RESET REST-BOX FLOOR TIMER 
REM PLAYER0,TIMER3 WAIT TILL WHITE TELEPORT TIMER
REM PLAYER0,TIMER4 GOLD EFFECT TIMER
REM PLAYER0,TIMER5 SUDDEN DEATH

LEVEL_VERSION(1)


IF(PLAYER0, DUNGEON_DESTROYED == 0)
    IF(PLAYER1, DUNGEON_DESTROYED == 0)

        prepPhase()
        REM Preparing phase


        If(Game.FIGHT_PHASE_ENDED > 0)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(40, 40, LIBRARY_WALL, MATCH)
        ENDIF



        IF(PLAYER0, TIMER4 > 25)
            REM row1
            REM BILE DEMON
            IF(Game.CREATURE_GOLDPRICE_COLLUM1 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 43, 250)
            ENDIF
            REM BUG
            IF(Game.CREATURE_GOLDPRICE_COLLUM2 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 44, 50)
            ENDIF
            REM DARK MISTRESS
            IF(Game.CREATURE_GOLDPRICE_COLLUM3 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 45, 450)
            ENDIF
            REM DEMONSPAWN
            IF(Game.CREATURE_GOLDPRICE_COLLUM4 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 46, 180)
            ENDIF
            REM DRAGON
            IF(Game.CREATURE_GOLDPRICE_COLLUM5 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 47, 700)
            ENDIF
            REM DRUID
            IF(Game.CREATURE_GOLDPRICE_COLLUM6 == 1)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 48, 350)
            ENDIF
            REM row2
            REM FLY
            IF(Game.CREATURE_GOLDPRICE_COLLUM1 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 43, 10)
            ENDIF
            REM GHOST
            IF(Game.CREATURE_GOLDPRICE_COLLUM2 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 44, 50)
            ENDIF
            REM HELL HOUND
            IF(Game.CREATURE_GOLDPRICE_COLLUM3 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 45, 170)
            ENDIF
            REM HORNY
            IF(Game.CREATURE_GOLDPRICE_COLLUM4 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 46, 1200)
            ENDIF
            REM ORC
            IF(Game.CREATURE_GOLDPRICE_COLLUM5 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 47, 200)
            ENDIF
            REM SKELETON
            IF(Game.CREATURE_GOLDPRICE_COLLUM6 == 2)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 48, 180)
            ENDIF

            REM row3
            REM WARLOCK
            IF(Game.CREATURE_GOLDPRICE_COLLUM1 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 43, 100)
            ENDIF
            REM SPIDER
            IF(Game.CREATURE_GOLDPRICE_COLLUM2 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 44, 80)
            ENDIF
            REM TENTACLE
            IF(Game.CREATURE_GOLDPRICE_COLLUM3 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 45, 110)
            ENDIF
            REM TIMEMAGE
            IF(Game.CREATURE_GOLDPRICE_COLLUM4 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 46, 420)
            ENDIF
            REM TROLL
            IF(Game.CREATURE_GOLDPRICE_COLLUM5 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 47, 130)
            ENDIF
            REM VAMPIRE
            IF(Game.CREATURE_GOLDPRICE_COLLUM6 == 3)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 48, 600)
            ENDIF
            NEXT_COMMAND_REUSABLE
            SET_TIMER(PLAYER0, TIMER4)
        ENDIF


        REM 4-2 Activate Creature Boxes
        IF(Game.CREATURE_RANDOM == 2)
            REM row1
            activateCreatureBoxes()
        ENDIF

        IF(Game.CREATURE_RANDOM < 6)
            NEXT_COMMAND_REUSABLE
            SET_TIMER(PLAYER0, TIMER3)
        ENDIF
        IF(PLAYER0, TIMER3 > 10)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.CREATURE_RANDOM, 3)
        ENDIF

        REM 4-3 Remove the other Boxes and Creatrures
        IF(Game.CREATURE_RANDOM == 3)
            NEXT_COMMAND_REUSABLE
            USE_SPELL_ON_PLAYERS_CREATURES(PLAYER_GOOD, ANY_CREATURE, SPELL_TELEPORT)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(40, 46, LAVA, MATCH)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.DESTROY_BOXES_TIMER, 1)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.CREATURE_RANDOM, 4)
        ENDIF

        REM Timer to remake the floor
        IF(Game.DESTROY_BOXES_TIMER == 0)
            NEXT_COMMAND_REUSABLE
            SET_TIMER(PLAYER0, TIMER1)
        ENDIF
        IF(PLAYER0, TIMER1 > 5)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.DESTROY_BOXES_TIMER, 0)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(40, 46, PATH, MATCH)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_OWNER(40, 46, PLAYER0, MATCH)
        ENDIF

        REM 4-4 Wait before continue
        IF(Game.DESTROY_BOXES_TIMER == 0)
            IF(Game.CREATURE_RANDOM == 4)
                REM be sure to you have take away your creature
                NEXT_COMMAND_REUSABLE
                COUNT_CREATURES_AT_ACTION_POINT(65, PLAYER0, ANY_CREATURE, Game.PLAYER0_LEFT_CREATURE_COUNT)
                NEXT_COMMAND_REUSABLE
                COUNT_CREATURES_AT_ACTION_POINT(66, PLAYER0, ANY_CREATURE, Game.PLAYER0_RIGHT_CREATURE_COUNT)
                REM WTF
                IF(Game.PLAYER0_LEFT_CREATURE_COUNT == Game.PLAYER0_RIGHT_CREATURE_COUNT)
                    IF(Game.PREPARNG_PHASE == 1)
                        NEXT_COMMAND_REUSABLE
                        SET_FLAG(Game.DESTROY_BOXES_TIMER, 1)
                        NEXT_COMMAND_REUSABLE
                        SET_FLAG(Game.CREATURE_RANDOM, 5)
                    ENDIF
                ENDIF
            ENDIF
        ENDIF

        REM 4-5 Place Enemy Creature
        IF(Game.CREATURE_RANDOM == 5)
            placeEnemyCreatures()
        ENDIF

        REM PREPARING COUNTDOWN-1
        IF(Game.PREPARING_COUNTDOWN == 1)
            NEXT_COMMAND_REUSABLE
            BONUS_LEVEL_TIME(0, 1)
            NEXT_COMMAND_REUSABLE
            SET_TIMER(PLAYER0, TIMER0)
        ENDIF
        IF(Game.PREPARING_COUNTDOWN == 0)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.CREATURE_RANDOM, 3)
            NEXT_COMMAND_REUSABLE
            BONUS_LEVEL_TIME(60, 1)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.PREPARNG_PHASE, 0)
            REM Reset Reset- and Free-Imp-Box-1
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(38, 46, LAVA, NONE)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(38, 48, LAVA, NONE)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.RESET_RESET-BOX_AND_FREE-IMP-BOX, 0)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.PREPARING_COUNTDOWN, 2)
        ENDIF

        REM Reset Reset- and Free-Imp-Box-2
        IF(Game.RESET_RESET-BOX_AND_FREE-IMP-BOX == 1)
            NEXT_COMMAND_REUSABLE
            SET_TIMER(PLAYER0, TIMER2)
        ENDIF
        REM Reset Reset- and Free-Imp-Box-3
        IF(PLAYER0, TIMER2 > 5)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(38, 46, PATH, NONE)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_OWNER(38, 46, PLAYER0, NONE)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_TYPE(38, 48, PATH, NONE)
            NEXT_COMMAND_REUSABLE
            CHANGE_SLAB_OWNER(38, 48, PLAYER0, NONE)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.RESET_RESET-BOX_AND_FREE-IMP-BOX, 1)
        ENDIF

        REM PREPARING COUNTDOWN-2
        IF(PLAYER0, TIMER0 > 60)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.FIGHT_PHASE_ENDED, 0)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.PREPARING_COUNTDOWN, 1)
        ENDIF


        REM END PREPERING PHASE 
        IF(Game.PREPARNG_PHASE == 1)
            NEXT_COMMAND_REUSABLE
            COUNT_CREATURES_AT_ACTION_POINT(63, PLAYER0, ANY_CREATURE, Game.PLAYER_COUNTER_CREATURE)
            REM Wait for place all Creature to start Countdown
            IF(Game.PLAYER_COUNTER_CREATURE == Game.MaxCreatures)
                NEXT_COMMAND_REUSABLE
                SET_FLAG(Game.PREPARING_COUNTDOWN, 0)
            ENDIF
        ENDIF










        REM End phase
        If(Game.END_PASE == 1)
            IF(PLAYER0, BOX20_ACTIVATED == 2)
                NEXT_COMMAND_REUSABLE
                SET_FLAG(PLAYER0, BOX20_ACTIVATED, 0)
            ENDIF
            If(Game.MaxCreatures == 1)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 500)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 500)
            ENDIF
            If(Game.MaxCreatures == 2)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 550)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 550)
            ENDIF
            If(Game.MaxCreatures == 3)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 600)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 600)
            ENDIF
            If(Game.MaxCreatures == 4)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 650)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 650)
            ENDIF
            If(Game.MaxCreatures == 5)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 700)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 700)
            ENDIF
            If(Game.MaxCreatures == 6)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 750)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 750)
            ENDIF
            If(Game.MaxCreatures == 7)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 800)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 800)
            ENDIF
            If(Game.MaxCreatures == 8)
                NEXT_COMMAND_REUSABLE
                ADD_GOLD_TO_PLAYER(PLAYER0, 850)
                NEXT_COMMAND_REUSABLE
                CREATE_EFFECT(EFFECTELEMENT_PRICE, 80, 850)
            ENDIF
            If(Game.PREPARNG_PHASE == 0)
                NEXT_COMMAND_REUSABLE
                ADD_TO_FLAG(Game.MaxCreatures, 1)
                NEXT_COMMAND_REUSABLE
                prepPhase()
                REM Respawn RESET-BOX
                NEXT_COMMAND_REUSABLE
                ADD_OBJECT_TO_LEVEL_AT_POS(SPECBOX_CUSTOM, 115, 139, 19, PLAYER0)
                NEXT_COMMAND_REUSABLE
                ADD_OBJECT_TO_LEVEL_AT_POS(SPECBOX_CUSTOM, 115, 145, 20, PLAYER0)
                NEXT_COMMAND_REUSABLE
                SET_FLAG(Game.END_PASE, 0)
            ENDIF
            NEXT_COMMAND_REUSABLE
            MOVE_CREATURE(PLAYER0, ANY_CREATURE, AT_ACTION_POINT[63], 20, PLAYER_GOOD, EFFECT_BALL_PUFF_RED)
            NEXT_COMMAND_REUSABLE
            MOVE_CREATURE(PLAYER1, ANY_CREATURE, AT_ACTION_POINT[63], 20, PLAYER_GOOD, EFFECT_BALL_PUFF_BLUE)
            REM Round reward
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.PLAYER_ROW_CREATURE_RANDOM, 0)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.PLAYER_COLLUM_CREATURE_RANDOM, 4)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.FIGHT_PHASE_ENDED, 1)
            NEXT_COMMAND_REUSABLE
            SET_FLAG(Game.Player1CreatureCount, 0)
        ENDIF
    ENDIF
ENDIF
REM GAME END
